# Implementation Plan: TUI Interactive Screens

**Branch**: `013-tui-interactive-screens` | **Date**: 2025-12-17 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/013-tui-interactive-screens/spec.md`

## Summary

Implement interactive screens (HomeScreen, FlyScreen, RefuelScreen, ReviewScreen, SettingsScreen) for Maverick's TUI. The screens will integrate with widgets from spec 012 and layout from spec 011 to provide workflow launching, code review interactions, issue selection, and configuration management. Each screen will be a Textual Screen subclass with reactive state management, keyboard navigation, and modal dialog support.

## Technical Context

**Language/Version**: Python 3.10+ (with `from __future__ import annotations`)
**Primary Dependencies**: Textual 0.40+, Click (CLI), Pydantic (configuration models)
**Storage**: JSON file at `~/.config/maverick/history.json` for workflow history
**Testing**: pytest + pytest-asyncio with Textual pilot fixture for TUI testing
**Target Platform**: Cross-platform terminal (80×24 minimum terminal size)
**Project Type**: Single project (TUI application)
**Performance Goals**: <300ms screen transitions, <200ms validation feedback, <100ms modal display
**Constraints**: Keyboard-first navigation, 100% keyboard accessibility required
**Scale/Scope**: 5 screens, 50 workflow history entries max, 200 findings max

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| Principle | Compliance | Notes |
|-----------|------------|-------|
| I. Async-First | ✅ PASS | All screen updates via async Textual message passing; workflow execution yields async events |
| II. Separation of Concerns | ✅ PASS | Screens present state only; business logic in workflows/agents; TUI receives immutable snapshots |
| III. Dependency Injection | ✅ PASS | Screens receive workflow executors and config via constructor; no global state |
| IV. Fail Gracefully | ✅ PASS | Error modals with retry options; workflow cancellation with summary; network loss handling |
| V. Test-First | ✅ PASS | TDD with Textual pilot fixture; mock workflow data; comprehensive acceptance scenario coverage |
| VI. Type Safety | ✅ PASS | All public APIs typed; Screen state via frozen dataclasses/Pydantic models |
| VII. Simplicity | ✅ PASS | No premature abstractions; screens compose existing widgets; minimal custom widget creation |
| VIII. Relentless Progress | ✅ PASS | Workflow history persists progress; network recovery auto-resumes; partial results preserved |

## Project Structure

### Documentation (this feature)

```text
specs/013-tui-interactive-screens/
├── plan.md              # This file
├── research.md          # Textual Screen patterns, navigation, modals
├── data-model.md        # Screen state models, history entry schema
├── quickstart.md        # Getting started with interactive screens
├── contracts/           # Screen component interfaces
└── tasks.md             # Implementation tasks (generated by /speckit.tasks)
```

### Source Code (repository root)

```text
src/maverick/
├── tui/
│   ├── app.py           # MaverickApp - enhanced with navigation context
│   ├── maverick.tcss    # Stylesheet - extended for new screens
│   ├── models.py        # Data models - extended with new screen states
│   ├── history.py       # NEW: Workflow history persistence
│   ├── screens/
│   │   ├── __init__.py  # Screen exports
│   │   ├── home.py      # HomeScreen - enhanced with history display
│   │   ├── fly.py       # NEW: FlyScreen - workflow launcher
│   │   ├── refuel.py    # NEW: RefuelScreen - issue processor
│   │   ├── review.py    # ReviewScreen - enhanced with actions
│   │   ├── settings.py  # NEW: SettingsScreen (replaces config.py)
│   │   └── base.py      # NEW: MaverickScreen base class
│   └── widgets/
│       ├── modal.py     # NEW: ConfirmDialog, ErrorDialog, InputDialog
│       ├── form.py      # NEW: Form widgets for FlyScreen/SettingsScreen
│       └── issue_list.py # NEW: GitHub issue list for RefuelScreen

tests/unit/tui/
├── screens/
│   ├── test_home.py     # Enhanced with history tests
│   ├── test_fly.py      # NEW: FlyScreen tests
│   ├── test_refuel.py   # NEW: RefuelScreen tests
│   ├── test_review.py   # Enhanced with action tests
│   └── test_settings.py # NEW: SettingsScreen tests
├── test_history.py      # NEW: History persistence tests
└── widgets/
    ├── test_modal.py    # NEW: Modal dialog tests
    ├── test_form.py     # NEW: Form widget tests
    └── test_issue_list.py # NEW: Issue list tests
```

**Structure Decision**: Extends existing TUI structure. New screens in `screens/`, new widgets in `widgets/`. History persistence isolated in `history.py`. Base screen class provides common navigation and modal support.

## Complexity Tracking

No constitution violations - design adheres to all principles.
